<!DOCTYPE html>
  <html lang="ru">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DuckWeb - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs4/dt-1.10.21/datatables.min.css"/>
    <!-- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
      .header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 1rem 0;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      }
      
      .header-content {
        max-width: 1400px;
        margin: 0 auto;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 20px;
      }
      
      .logo {
        font-size: 2rem;
        font-weight: bold;
        margin: 0;
      }
      
      .header-buttons {
        display: flex;
        gap: 15px;
      }
      
      .header-button {
        padding: 10px 20px;
        border-radius: 25px;
        font-weight: 500;
        transition: all 0.3s ease;
      }
      
      .header-button-join-room {
        border: 2px solid white;
      }
      
      .header-button-create-room {
        background: rgba(255,255,255,0.2);
        border: 2px solid transparent;
      }

      .header-button-upload {
        background: rgba(255,255,255,0.3);
        border: 2px solid rgba(255,255,255,0.5);
      }
      
      .header-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      }
      
      /* –°—Ç–∏–ª–∏ –¥–ª—è –≤–ª–æ–∂–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã */
      .nested-table-section {
        max-width: 1400px;
        margin: 30px auto;
        padding: 0 20px;
      }
      
      .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }
      
      .section-title {
        color: #333;
        font-size: 1.5rem;
        font-weight: 600;
      }
      
      .section-actions {
        display: flex;
        gap: 10px;
      }
      
      .action-btn {
        padding: 10px 20px;
        border-radius: 20px;
        font-weight: 500;
        transition: all 0.3s ease;
        font-size: 0.95rem;
        white-space: nowrap;
      }

      .toggle-expand-btn {
        position: relative;
        overflow: hidden;
        min-width: 160px;
        padding: 10px 24px;
      }

      .toggle-expand-btn .expand-icon,
      .toggle-expand-btn .collapse-icon {
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
      }

      .toggle-expand-btn .collapse-icon {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        opacity: 0;
      }

      .toggle-expand-btn.expanded .expand-icon {
        transform: scale(0);
        opacity: 0;
      }

      .toggle-expand-btn.expanded .collapse-icon {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
      }
      
      .nested-table {
        width: 100%;
        background: white;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        min-height: 400px;
      }
      
      /* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç—Ä–æ–∫ –∫–æ–º–Ω–∞—Ç */
      .room-row {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        cursor: pointer;
        transition: all 0.3s ease;
        border-bottom: 1px solid rgba(255,255,255,0.1);
      }
      
      .room-row:hover {
        background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
      }
      
      .room-header {
        padding: 15px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      
      .room-info {
        display: flex;
        align-items: center;
        gap: 15px;
      }
      
      .triangle-icon {
        width: 16px;
        height: 16px;
        transition: transform 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      
      .triangle-icon::before {
        content: '';
        width: 0;
        height: 0;
        border-left: 5px solid transparent;
        border-right: 5px solid transparent;
        border-top: 8px solid white;
        transition: transform 0.3s ease;
      }
      
      .triangle-icon-blue::before {
        border-top-color: #667eea;
      }
      
      .expanded .triangle-icon::before {
        transform: rotate(90deg);
      }
      
      .room-name {
        font-size: 1.1rem;
        font-weight: 600;
      }
      
      .room-code {
        background: rgba(255,255,255,0.2);
        padding: 4px 12px;
        border-radius: 15px;
        font-size: 0.85rem;
      }
      
      .room-stats {
        display: flex;
        gap: 20px;
        font-size: 0.9rem;
        opacity: 0.9;
      }
      
      /* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç—Ä–æ–∫ –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ */
      .computer-row {
        background: #f8f9fa;
        cursor: pointer;
        transition: all 0.2s ease;
        border-bottom: 1px solid #e9ecef;
      }
      
      .computer-row:hover {
        background: #e9ecef;
      }
      
      .computer-header {
        padding: 12px 20px 12px 50px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      
      .computer-info {
        display: flex;
        align-items: center;
        gap: 12px;
      }
      
      .computer-status {
        width: 10px;
        height: 10px;
        border-radius: 50%;
      }
      
      .status-online {
        background-color: #28a745;
      }
      
      .status-offline {
        background-color: #dc3545;
      }
      
      .status-busy {
        background-color: #ffc107;
      }
      
      .computer-name {
        font-weight: 500;
        color: #495057;
      }
      
      .computer-ip {
        color: #6c757d;
        font-size: 0.85rem;
      }
      
      .computer-stats {
        display: flex;
        gap: 15px;
        font-size: 0.85rem;
        color: #6c757d;
      }
      
      /* –°—Ç–∏–ª–∏ –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–≥—Ä—É–∑–æ–∫ */
      .files-history {
        background: white;
      }
      
      .files-table {
        width: 100%;
        background: white;
      }
      
      .files-table th {
        background: #e9ecef;
        color: #495057;
        padding: 12px 20px;
        font-weight: 500;
        text-align: left;
        font-size: 0.9rem;
      }
      
      .files-table td {
        padding: 12px 20px;
        border-bottom: 1px solid #f1f3f4;
        vertical-align: middle;
        font-size: 0.9rem;
      }
      
      .file-row {
        padding-left: 80px !important;
        transition: background-color 0.2s ease;
      }
      
      .file-row:hover {
        background-color: #f8f9fa;
      }
      
      .file-info {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      
      .file-icon {
        color: #667eea;
        width: 20px;
        text-align: center;
      }
      
      .file-details {
        display: flex;
        flex-direction: column;
      }
      
      .file-name {
        font-weight: 500;
        color: #333;
      }
      
      .file-meta {
        font-size: 0.8rem;
        color: #6c757d;
      }
      
      .status-badge {
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 500;
      }
      
      .status-uploaded {
        background-color: #d4edda;
        color: #155724;
      }
      
      .status-pending {
        background-color: #fff3cd;
        color: #856404;
      }
      
      .status-error {
        background-color: #f8d7da;
        color: #721c24;
      }
      
      .empty-message {
        text-align: center;
        padding: 40px;
        color: #6c757d;
        font-style: italic;
      }
      
      .loading-message {
        text-align: center;
        padding: 60px 20px;
        color: #6c757d;
      }
      
      .spinner {
        width: 40px;
        height: 40px;
        border: 4px solid #f3f3f3;
        border-top: 4px solid #667eea;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
      }
      
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      body {
        background-color: #f8f9fa;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      }

      .computer-specs {
        font-size: 0.8rem;
        color: #6c757d;
        margin-top: 5px;
      }

      .last-active {
        font-size: 0.8rem;
        color: #6c757d;
      }

      .connection-status {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px 20px;
        background: #fff3cd;
        border-left: 4px solid #ffc107;
        margin-bottom: 20px;
        border-radius: 5px;
      }

      .connection-status.connected {
        background: #d4edda;
        border-left-color: #28a745;
      }

      .connection-status.error {
        background: #f8d7da;
        border-left-color: #dc3545;
      }
    </style>
  </head>
  <body>
    <header class="header">
      <div class="header-content">
        <h1 class="logo">DuckWeb</h1>
        <div class="header-buttons">
          <button class="btn btn-outline-light header-button header-button-join-room" data-bs-toggle="modal" data-bs-target="#joinRoomModal">
            <i class="fas fa-door-open"></i>
            –í–æ–π—Ç–∏ –≤ –∫–æ–º–Ω–∞—Ç—É
          </button>
          <button class="btn btn-primary header-button header-button-create-room" id="createRoomBtn">
            <i class="fas fa-plus-circle"></i>
            –°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É
          </button>
          <button class="btn btn-outline-light header-button header-button-upload" id="uploadFilesBtn">
            <i class="fas fa-cloud-upload-alt"></i>
            –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã
          </button>
        </div>
      </div>
    </header>

    <!-- –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è -->
    <div class="nested-table-section">
      <div class="connection-status" id="connectionStatus">
        <div class="spinner" style="width: 20px; height: 20px; border-width: 2px;"></div>
        <span>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É...</span>
      </div>
    </div>

    <!-- –í–ª–æ–∂–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ -->
    <div class="nested-table-section">
      <div class="section-header">
        <h2 class="section-title">–ö–æ–º–Ω–∞—Ç—ã –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã</h2>
        <div class="section-actions">
          <button class="btn btn-outline-secondary action-btn" id="refreshTable">
            <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
          </button>
          <button class="btn btn-outline-primary action-btn toggle-expand-btn" id="toggleExpandBtn">
            <span class="expand-icon">
              <i class="fas fa-expand"></i> –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ
            </span>
            <span class="collapse-icon">
              <i class="fas fa-compress"></i> –°–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ
            </span>
          </button>
        </div>
      </div>
      
      <div class="nested-table" id="nestedTable">
        <div class="loading-message">
          <div class="spinner"></div>
          <h4>–û–∂–∏–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞...</h4>
          <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ, –ø–æ–∫–∞ —Å–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∑–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–º–Ω–∞—Ç–∞—Ö –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö</p>
        </div>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –∫–æ–º–Ω–∞—Ç—É -->
    <div class="modal fade" id="joinRoomModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">–í–æ–π—Ç–∏ –≤ –∫–æ–º–Ω–∞—Ç—É</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label for="roomCodeInput" class="form-label">–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã</label>
              <input type="text" class="form-control" id="roomCodeInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∫–æ–º–Ω–∞—Ç—ã">
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
            <button type="button" class="btn btn-primary" id="joinRoomBtn">–í–æ–π—Ç–∏</button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/v/bs4/dt-1.10.21/datatables.min.js"></script>
    
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const nestedTable = document.getElementById('nestedTable');
        const connectionStatus = document.getElementById('connectionStatus');
        const refreshBtn = document.getElementById('refreshTable');
        const toggleExpandBtn = document.getElementById('toggleExpandBtn');
        const createRoomBtn = document.getElementById('createRoomBtn');
        const joinRoomBtn = document.getElementById('joinRoomBtn');
        const uploadFilesBtn = document.getElementById('uploadFilesBtn');
        
        // –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø—É—Å—Ç—ã–µ)
        let roomsData = [];
        let isConnected = false;
        let isAllExpanded = false;

        // üî• –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –û–ë–†–ê–ë–û–¢–ß–ò–ö –ö–ù–û–ü–ö–ò –ó–ê–ì–†–£–ó–ö–ò –§–ê–ô–õ–û–í
        uploadFilesBtn.addEventListener('click', function() {
          if (!isConnected) {
            alert('–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É');
            return;
          }

          // üî• –ü–†–û–°–¢–û –ü–ï–†–ï–•–û–î–ò–ú –ù–ê –°–¢–†–ê–ù–ò–¶–£ Art2.html –ë–ï–ó –û–¢–ü–†–ê–í–ö–ò –î–ê–ù–ù–´–•
          console.log('üîó –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤...');
          window.location.href = '/art2';
        });

        // –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É
        function connectToServer() {
          console.log('üîÑ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É...');
          
          // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏ —Å–µ—Ç–∏
          setTimeout(() => {
            console.log('‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
            isConnected = true;
            connectionStatus.innerHTML = `
              <i class="fas fa-check-circle" style="color: #28a745;"></i>
              <span>–ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ —Å–µ—Ä–≤–µ—Ä—É</span>
            `;
            connectionStatus.className = 'connection-status connected';
            
            // –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            loadDataFromServer();
          }, 2000);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ rooms.json
        function loadDataFromServer() {
          console.log('üì• –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ rooms.json...');
          
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–≥—Ä—É–∑–∫–µ
          nestedTable.innerHTML = `
            <div class="loading-message">
              <div class="spinner"></div>
              <h4>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</h4>
              <p>–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–º–Ω–∞—Ç–∞—Ö –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö</p>
            </div>
          `;

          fetch('rooms.json?t=' + new Date().getTime())
            .then(response => {
              if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ rooms.json');
              return response.json();
            })
            .then(data => {
              // –ü—Ä–æ–≤–µ—Ä—è–µ–º: –µ—Å–ª–∏ data –º–∞—Å—Å–∏–≤ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞–ø—Ä—è–º—É—é, –µ—Å–ª–∏ –æ–±—ä–µ–∫—Ç —Å –∫–ª—é—á–æ–º "rooms" ‚Äî –±–µ—Ä–µ–º data.rooms
              if (Array.isArray(data)) {
                roomsData = data;
              } else if (data.rooms && Array.isArray(data.rooms)) {
                roomsData = data.rooms;
              } else {
                throw new Error('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç rooms.json');
              }
              renderNestedTable(); // –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç–∞–±–ª–∏—Ü—ã
            })
            .catch(err => {
              console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ rooms.json:', err);
              alert('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–æ–º–Ω–∞—Ç. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞ rooms.json –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –ø—É—Ç–∏.');
            });
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
        function showErrorMessage(message) {
          connectionStatus.innerHTML = `
            <i class="fas fa-exclamation-triangle" style="color: #dc3545;"></i>
            <span>${message}</span>
          `;
          connectionStatus.className = 'connection-status error';
          
          nestedTable.innerHTML = `
            <div class="empty-message">
              <i class="fas fa-exclamation-triangle fa-2x mb-3" style="color: #dc3545;"></i>
              <h4>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</h4>
              <p>${message}</p>
            </div>
          `;
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function initApp() {
          // –ù–∞—á–∏–Ω–∞–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
          connectToServer();
          
          // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ —Ç–∞–±–ª–∏—Ü—ã
          refreshBtn.addEventListener('click', function() {
            if (!isConnected) {
              alert('–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É');
              return;
            }
            loadDataFromServer();
          });
          
          // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è/—Å–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
          toggleExpandBtn.addEventListener('click', function() {
            if (roomsData.length === 0) {
              alert('–î–∞–Ω–Ω—ã–µ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
              return;
            }
            
            isAllExpanded = !isAllExpanded;
            
            roomsData.forEach(room => {
              room.expanded = isAllExpanded;
              room.computers.forEach(computer => {
                computer.expanded = isAllExpanded;
              });
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
            if (isAllExpanded) {
              toggleExpandBtn.classList.add('expanded');
            } else {
              toggleExpandBtn.classList.remove('expanded');
            }
            
            renderNestedTable();
          });
          
          // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç—ã
          createRoomBtn.addEventListener('click', function() {
            if (!isConnected) {
              alert('–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É');
              return;
            }
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
            alert('–§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç—ã –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö');
          });
          
          // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Ö–æ–¥–∞ –≤ –∫–æ–º–Ω–∞—Ç—É
          joinRoomBtn.addEventListener('click', function() {
            if (!isConnected) {
              alert('–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É');
              return;
            }
            const roomCode = document.getElementById('roomCodeInput').value.trim().toUpperCase();
            if (!roomCode) {
              alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∫–æ–º–Ω–∞—Ç—ã.');
              return;
            }
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
            alert(`–ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—Ö–æ–¥ –≤ –∫–æ–º–Ω–∞—Ç—É ${roomCode} –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä`);
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            const modal = bootstrap.Modal.getInstance(document.getElementById('joinRoomModal'));
            modal.hide();
          });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –≤–ª–æ–∂–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
        function renderNestedTable() {
          if (roomsData.length === 0) {
            nestedTable.innerHTML = `
              <div class="empty-message">
                <i class="fas fa-door-closed fa-2x mb-3"></i>
                <h4>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</h4>
                <p>–ö–æ–º–Ω–∞—Ç—ã –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
              </div>
            `;
            return;
          }
          
          nestedTable.innerHTML = roomsData.map(room => `
            <div class="room-row ${room.expanded ? 'expanded' : ''}" data-room-id="${room.id}">
              <div class="room-header">
                <div class="room-info">
                  <div class="triangle-icon"></div>
                  <span class="room-name">${room.name}</span>
                  <span class="room-code">${room.code}</span>
                </div>
                <div class="room-stats">
                  <span><i class="fas fa-desktop"></i> ${room.computers.length} –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤</span>
                  <span><i class="fas fa-file"></i> ${getTotalFilesInRoom(room)} —Ñ–∞–π–ª–æ–≤</span>
                </div>
              </div>
            </div>
            ${room.expanded ? `
              <div class="room-computers">
                ${room.computers.map(computer => `
                  <div class="computer-row ${computer.expanded ? 'expanded' : ''}" data-computer-id="${computer.id}">
                    <div class="computer-header">
                      <div class="computer-info">
                        <div class="triangle-icon triangle-icon-blue"></div>
                        <div class="computer-status status-${computer.status}"></div>
                        <div>
                          <div class="computer-name">${computer.name}</div>
                          <div class="computer-ip">${computer.ip}</div>
                        </div>
                      </div>
                      <div class="computer-stats">
                        <div class="last-active">${computer.lastActive}</div>
                        <span><i class="fas fa-file"></i> ${computer.files.length} —Ñ–∞–π–ª–æ–≤</span>
                      </div>
                    </div>

                  </div>
                  ${computer.expanded ? `
                    <div class="files-history">
                      ${computer.files.length > 0 ? `
                        <table class="files-table">
                          <thead>
                            <tr>
                              <th>–§–∞–π–ª</th>
                              <th>–†–∞–∑–º–µ—Ä</th>
                              <th>–¢–∏–ø</th>
                              <th>–°—Ç–∞—Ç—É—Å</th>
                            </tr>
                          </thead>
                          <tbody>
                            ${computer.files.map(file => `
                              <tr class="file-row">
                                <td>
                                  <div class="file-info">
                                    <i class="fas fa-file${getFileIcon(file.type)} file-icon"></i>
                                    <div class="file-details">
                                      <div class="file-name">${file.name}</div>
                                    </div>
                                  </div>
                                </td>
                                <td>${file.size}</td>
                                <td>${file.type}</td>
                                <td>
                                  <span class="status-badge status-${file.status}">
                                    ${getStatusText(file.status)}
                                  </span>
                                </td>
                              </tr>
                            `).join('')}
                          </tbody>
                        </table>
                      ` : `
                        <div class="empty-message" style="padding-left: 80px;">
                          <i class="fas fa-inbox fa-lg mb-2"></i>
                          <p>–ù–∞ —ç—Ç–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –Ω–µ—Ç —Ñ–∞–π–ª–æ–≤</p>
                        </div>
                      `}
                    </div>
                  ` : ''}
                `).join('')}
              </div>
            ` : ''}
          `).join('');
          
          // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤ –¥–ª—è —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è/—Å–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è
          nestedTable.querySelectorAll('.room-row').forEach(row => {
            row.addEventListener('click', function() {
              const roomId = parseInt(this.dataset.roomId);
              const room = roomsData.find(r => r.id === roomId);
              if (room) {
                room.expanded = !room.expanded;
                renderNestedTable();
              }
            });
          });
          
          nestedTable.querySelectorAll('.computer-row').forEach(row => {
            row.addEventListener('click', function(e) {
              e.stopPropagation();
              const computerId = parseInt(this.dataset.computerId);
              const computer = findComputerById(computerId);
              if (computer) {
                computer.expanded = !computer.expanded;
                renderNestedTable();
              }
            });
          });
        }
        
        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function getFileIcon(fileType) {
          const icons = {
            'PDF –¥–æ–∫—É–º–µ–Ω—Ç': '-pdf',
            'Word –¥–æ–∫—É–º–µ–Ω—Ç': '-word',
            'Excel —Ç–∞–±–ª–∏—Ü–∞': '-excel',
            '–ê—Ä—Ö–∏–≤': '-archive',
            '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ': '-image',
            'Python —Å–∫—Ä–∏–ø—Ç': '-code',
            '–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö': '-database'
          };
          return icons[fileType] || '';
        }
        
        function getStatusText(status) {
          const statusMap = {
            'pending': '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ',
            'uploaded': '–ó–∞–≥—Ä—É–∂–µ–Ω',
            'error': '–û—à–∏–±–∫–∞'
          };
          return statusMap[status] || status;
        }
        
        function findComputerById(computerId) {
          for (const room of roomsData) {
            const computer = room.computers.find(comp => comp.id === computerId);
            if (computer) return computer;
          }
          return null;
        }
        
        function getTotalFilesInRoom(room) {
          return room.computers.reduce((total, computer) => total + computer.files.length, 0);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        initApp();
      });
    </script>

    <script src="sync.js"></script>

  </body>
  </html>